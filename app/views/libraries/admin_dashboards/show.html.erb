<h1>Admin Dashboard for <%= @library.name %></h1>
<p>Library ID: <%= @library.id %></p>

<%# Books Section %>
<h2>Books</h2>
<% if @library.books.any? %>
  <table>
    <thead>
      <tr>
        <th>Title</th>
        <th>Author</th>
        <th>Genre</th>
        <th>Year</th>
        <th>Quantity</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @library.books.each do |book| %>
        <tr>
          <td><%= book.title %></td>
          <td><%= book.author %></td>
          <td><%= book.genre %></td>
          <td><%= book.year %></td>
          <td><%= book.quantity %></td>
          <td><%= book.status %></td>
          <td>
            <%= link_to 'Show', library_book_path(@library, book) %>
            <% if policy(@library).update?(book) %>
              <%= link_to 'Edit', edit_library_book_path(@library, book) %>
            <% end %>
            <% if policy(@library).destroy?(book) %>
              <%= link_to 'Delete', library_book_path(@library, book), method: :delete, data: { confirm: 'Are you sure?' } %>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
  <%= link_to 'Add a New Book', new_library_book_path(@library) %>
<% else %>
  <p>No books found in this library.</p>
<% end %>

<%# Notifications Section %>
<h2>Notifications</h2>
<%= render 'notifications/form', library: @library %>
<h3>Recent Notifications</h3>
<% if @library.notifications.any? %>
  <ul>
    <% @library.notifications.order(created_at: :desc).limit(10).each do |notification| %>
      <li><%= notification.content %> - <%= notification.created_at.strftime('%B %d, %Y') %></li>
    <% end %>
  </ul>
<% else %>
  <p>No notifications available.</p>
<% end %>

<%# Pending Reservations Section %>
<h2>Pending Reservations</h2>
<% if @pending_checkouts.any? %>
  <table>
    <thead>
      <tr>
        <th>Book Title</th>
        <th>User</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @pending_checkouts.each do |checkout| %>
        <tr>
          <td><%= checkout.book.title %></td>
          <td><%= checkout.user.email %></td>
          <td><%= checkout.status %></td>
          <td>
            <%= link_to 'Approve', approve_reservation_library_checkout_path(@library, checkout), method: :patch %>
            <%= link_to 'Deny', deny_reservation_library_checkout_path(@library, checkout), method: :patch %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <p>No pending reservations.</p>
<% end %>