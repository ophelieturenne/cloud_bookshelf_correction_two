<div class="container-margin">
  <h1 class="text-center display-4 my-4">
    Discover the Book Collection at <span class="text-primary"><%= @library.name %></span>
  </h1>

  <% if @books.any? %>
    <div class="book-grid">
      <% @books.each do |book| %>
        <div class="book-card">
          <% if book.photo.attached? %>
            <!-- Book with Photo -->
            <div class="book-image" style="background-image: url(<%= url_for(book.photo) %>); background-size: cover; background-position: center; width: 200px; height: 300px;"></div>
          <% else %>
            <!-- Placeholder for Missing Photo -->
            <div class="book-placeholder">
              <p><%= book.title %></p>
            </div>
          <% end %>

          <!-- Book Details -->
          <div class="book-details">
            <p class="book-title"><strong>Title:</strong> <%= book.title %></p>
            <p class="book-status"><strong>Status:</strong> <%= book.status.humanize %></p>
            <p class="book-format"><strong>Format:</strong> <%= book.format.capitalize %></p>
          </div>

          <!-- Book Actions -->
          <div class="book-actions">
            <%= link_to 'View', library_book_path(@library, book), class: 'btn btn-primary btn-sm' %>
            <% if policy(book).update? %>
              <%= link_to 'Edit', edit_library_book_path(@library, book), class: 'btn btn-warning btn-sm' %>
            <% end %>
            <% if policy(book).destroy? %>
              <%= link_to 'Delete', library_book_path(@library, book), method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-danger btn-sm' %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <p class="alert alert-warning text-center">No books available in this library.</p>
  <% end %>

  <% if policy(@library.books.new).create? %>
    <%= link_to "Add New Book", new_library_book_path(@library), class: 'btn btn-success my-3' %>
  <% end %>

  <%= link_to "Back to Library", library_path(@library), class: 'btn btn-secondary' %>
</div>
